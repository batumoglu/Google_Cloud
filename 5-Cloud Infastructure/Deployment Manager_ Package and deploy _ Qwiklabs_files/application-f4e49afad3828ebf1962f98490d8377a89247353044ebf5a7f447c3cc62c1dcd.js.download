function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function status(t){return 200<=t.status&&t.status<300?Promise.resolve(t):Promise.reject(t)}function json(t){return t.json()}function text(t){return t.text()}var ql={getJson:function(t){return fetch(t,{credentials:"include"}).then(status).then(json)},getHtml:function(t){return fetch(t,{credentials:"include"}).then(status).then(text)},Poller:function(t,e,n,i){this.continuePolling=!0,this.path=t,this.timeout=e,this.success=n,this.failure=i||this.defaultFailure,this.start=function o(){var e=this;this.continuePolling&&ql.getJson(this.path).then(this.success).then(function(){return setTimeout(o.bind(e),e.timeout)})["catch"](function(t){e.stop(),e.failure(t)})},this.once=function(){ql.getJson(this.path).then(this.success)["catch"](this.failure)},this.stop=function(){this.continuePolling=!1},this.defaultFailure=function(t){console.log("Request failed",t)}},events:{},subscribe:function(e,n){return ql.events[e]=ql.events[e]||[],ql.events[e].push(n),{unsubscibe:function i(){var t=ql.events[e].indexOf(n);ql.events[e].splice(t,1)}}},publish:function(t,e){ql.events[t]&&ql.events[t].forEach(function(t){t.call(this,e)})},debounce:function(o,t,e){var s,a=arguments.length<=1||t===undefined?20:t,r=arguments.length<=2||e===undefined||e;return function(){var t=this,e=arguments,n=function n(){s=null,r||o.apply(t,e)},i=r&&!s;clearTimeout(s),s=setTimeout(n,a),i&&o.apply(t,e)}},showFlash:function(t,e){var n=$("#flash-sibling-before"),i=$('<div class="alert"></div>');"notice"==t?i.addClass("alert-success"):i.addClass("alert-error");var o=$('<a class="alert__close" data-dismiss="alert"><i class="fa fa-times"></i></a>'),s=$('<iframe class="l-ie-iframe-fix"></iframe>');i.text(e),i.append(o),i.append(s),$(".alert").remove(),i.insertAfter(n)},moveFlash:function(t){$(function(){return $("#flash-sibling-before").insertAfter(t)})}};$.widget("custom.userAutocomplete",$.ui.autocomplete,{_renderItem:function _renderItem(t,e){return $("<li>").attr("data-value",e.value).append(ql.renderAutocompleteUser(e)).appendTo(t)}}),ql.renderAutocompleteUser=function(t){return"newUser"==t.value?'<div class="add-new-user js-add-new-user">\n      <i class="material-icons">add</i> Add New User\n    </div>':"<div class='autocomplete--user'>\n      <img src='https://secure.gravatar.com/avatar/"+t.label.gravatar_hash+".jpg?s=80&d=mm'/>\n      <div>\n        "+t.label.email+"\n        <span>"+t.label.first_name+" "+t.label.last_name+"</span>\n      </div>\n    </div>"},ql.autocomplete=function(){function t(){$(".js-user-autocomplete").userAutocomplete({source:e}),$(document).on("nested:fieldAdded",function(t){t.field.find(".js-user-autocomplete").userAutocomplete({source:e})})}function e(t,e){var n="?q["+this.element[0].dataset.query+"]="+t.term;ql.getJson(this.element[0].dataset.autocomplete+n).then(function(t){e(t.map(function(t){return{label:t,value:t.email}}))})}return{init:t,source:e}}(),ql.setCookie=function(t,e,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="expires="+i.toUTCString();document.cookie=t+"="+e+";"+o+";path=/"},ql.hasAnalytics=function(){return"undefined"!=typeof analytics},ql.track=function(t,e){var n=arguments.length<=1||e===undefined?{}:e;ql.hasAnalytics()&&analytics.track(t,n)},ql.experiments=function(){function n(e){return i.find(function(t){return t.id===e})}function t(){return i}function e(t){var e=n(t);return null!=t&&e.variant}var i=[],o=document.querySelector('meta[name="active-experiments"]');if(o)try{i=JSON.parse(o.content)}catch(s){console.error(s)}else console.error("Missing active-experiments meta tag.");return{getActiveExperiments:t,getExperiment:n,getUserVariant:e}}(),ql.adminClassroomView=function(){function t(t){n=t,i=document.querySelector(".js-classroom-focuses"),e()}function e(){ql.getJson(n).then(function(t){return i.innerHTML=t.focuses}).then(function(){return setTimeout(e,1e4)})["catch"](function(t){return console.error(t.message)})}var n="",i="";return{init:t}}(),ql.analytics=function(){function t(){eventLinks=document.querySelectorAll("[data-analytics-action]"),eventLinks.forEach(function(t){return t.addEventListener("click",e,!1)})}function e(){ql.track(this.dataset.analyticsAction,{category:this.dataset.analyticsCategory,label:this.dataset.analyticsLabel})}return{init:t}}(),CampaignCodeModalSubmitEnable=function(){$("#campaign-code-modal-submit").prop("disabled",!1)},CampaignCodeModalSubmitDisable=function(){$("#campaign-code-modal-submit").prop("disabled",!0)},ql.catalogs={tracking:function(){function t(){document.querySelectorAll(".js-catalog-item-title a").forEach(function(t){return t.addEventListener("click",function(t){ql.track("clicked_catalog_list_item",{label:t.target.innerText,type:t.target.dataset.type})},!1)})}return{init:t}}(),filter:function(){function t(){$form=document.querySelector("#catalog-filter-form"),$form&&($inputs=$form.querySelectorAll("input"),$inputs.forEach(function(t){return t.addEventListener("click",e)}))}function e(t){var e="any",n=t.currentTarget.closest(".js-list-item"),i=n.querySelector('input[value="'+e+'"]');t.currentTarget.value===e?n.querySelectorAll('input:checked:not([value="'+e+'"])').forEach(function(t){a(t)}):i.checked&&a(i),n.querySelectorAll("input:checked").length||s(i),numActive=n.querySelectorAll('input:checked:not([value="'+e+'"])').length;var o=numActive?"("+numActive+")":"";n.querySelector(".active-filter-number").textContent=o,ql.track(this.checked?"checked_filter":"unchecked_filter",{label:this.id}),ql.catalogSearchFilter()}function n(t){return t.closest(".mdl-checkbox")}function s(t){n(t).classList.add("is-checked"),t.checked=!0}function a(t){n(t).classList.remove("is-checked"),t.checked=!1}return $form={},{init:t}}(),addItems:function(){function t(){$catalogItems=document.querySelector(".js-catalog-items"),$addButtons=document.querySelectorAll(".js-add-button"),$addButtons.forEach(function(t){t.addEventListener("click",e,!1)}),ql.subscribe("itemAdded",i)}function e(t){t.preventDefault(),t.stopImmediatePropagation(),$("#add_item_with_children").modal("hide"),n(this.href)}function n(t){fetch(t,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(t){return ql.publish("itemAdded",t)})["catch"](function(t){return console.log(t)})}function i(t){$firstCatalogItem=$catalogItems.querySelectorAll(".js-catalog-item")[0],$firstCatalogItem?$firstCatalogItem.insertAdjacentHTML("beforebegin",t.html):$catalogItems.insertAdjacentHTML("beforeend",t.html),$buttons=$catalogItems.querySelectorAll(".mdl-js-button"),$buttons.forEach(function(t){t.hasAttribute("data-upgraded")||componentHandler.upgradeElement(t)}),$visiblebuttons=$catalogItems.querySelectorAll(".js-item-visible"),$visiblebuttons.forEach(function(t){t.hasAttribute("data-listening")||ql.catalogs.editItems.upgradeVisibleButton(t)}),$priceFields=$catalogItems.querySelectorAll(".js-item-price"),$priceFields.forEach(function(t){t.hasAttribute("data-listening")||ql.catalogs.editItems.upgradePriceField(t)}),$oldItem=document.querySelector('.js-add-item[data-item="'+t.catalogableType+"_"+t.catalogableId+'"]'),$($oldItem).animate({height:0},200,function(){$oldItem.remove()})}return $addButtons=[],$catalogItems={},{init:t,addItem:n}}(),searchItems:function(){function t(){$active=window.localStorage.getItem("searchTab")?window.localStorage.getItem("searchTab"):"Labs",e(".js-tab"),e(".js-tab-content"),n(),$tabsContainer=document.querySelector(".js-catalogable-types"),$tabsContainer.addEventListener("click",i)}function e(t){$tabs=document.querySelectorAll(t),$tabs.forEach(function(t){t&&(t.dataset.tab==$active?t.classList.add("is-active"):t.classList.remove("is-active"))})}function n(){$paginationContainers=document.querySelectorAll(".pagination"),$paginationContainers.forEach(function(t){t&&(t.id!=$active.toLowerCase()?t.style.display="none":t.style.display="inline")})}function i(){$active=document.querySelector(".js-tab.is-active").dataset.tab,window.localStorage.setItem("searchTab",$active),n()}return{init:t}}(),dragAndDrop:function(){function t(){$modal=document.querySelector("#add_item_with_children"),$name=$modal.querySelector(".js-add-item-name"),$type=$modal.querySelector(".js-add-item-type"),$count=$modal.querySelector(".js-add-item-children-count"),$with_button=$modal.querySelector(".js-with-children"),$without_button=$modal.querySelector(".js-without-children"),$(".js-add-item").draggable({helper:"clone",appendTo:"body"}),$(".js-catalog-table").droppable({drop:e,activeClass:"is-droppable",hoverClass:"is-active"})}function e(t,e){var n=e.draggable[0];if(n.dataset.hasChildren){var i=n.dataset.name,o=n.dataset.type,s=n.dataset.children,a=n.querySelector(".js-add-with-children").href,r=n.querySelector(".js-add-without-children").href;$name.innerHTML=i,$type.innerHTML=o,$count.innerHTML=s,$with_button.href=a,$without_button.href=r,$("#add_item_with_children").modal("show")}else $addButton=n.querySelector(".js-add-button"),ql.catalogs.addItems.addItem($addButton.href)}return $addItems={},$modal={},$name={},$type={},$count={},$with_button={},$without_button={},{init:t}}(),editItems:function(){function t(){$catalogItems=document.querySelector(".js-catalog-items"),$visibleButtons=$catalogItems.querySelectorAll(".js-item-visible"),$visibleButtons.forEach(e),$priceFields=$catalogItems.querySelectorAll(".js-item-price"),$priceFields.forEach(n),ql.subscribe("itemUpdated",a)}function e(t){t.addEventListener("click",i,!1),t.dataset.listening="true"}function n(t){t.addEventListener("change",o,!1),t.dataset.listening="true"}function i(t){t.preventDefault(),t.stopImmediatePropagation(),s(this.href)}function o(){s(this.dataset.path.replace(/=.*/i,"="+this.value))}function s(t){fetch(t,{method:"PATCH",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(t){return ql.publish("itemUpdated",t)})["catch"](function(t){return console.log(t)})}function a(t){$item=$catalogItems.querySelector('[data-item = "'+t.id+'"]'),$visibleButton=$item.querySelector(".js-item-visible");var e=t.visible?"0":"1",n=t.visible?"text--success":"text--light",i=$visibleButton.href.replace(/=\d/i,"="+e);$visibleButton.href=i,$visibleButton.classList.remove("text--success"),$visibleButton.classList.remove("text--light"),$visibleButton.classList.add(n),t.price&&($priceField=$item.querySelector(".js-item-price"),$priceField.value=t.price)}return $catalogItems={},$visibleButtons={},$priceFields={},{init:t,upgradeVisibleButton:e,upgradePriceField:n}}(),edit:function(){function t(){$enableButton=document.querySelector(".js-enable-catalog"),$enableIcon=$enableButton.querySelector(".material-icons"),$enableButton.addEventListener("click",e,!1),$fraudButton=document.querySelector(".js-fraud-catalog"),$fraudIcon=$fraudButton.querySelector(".material-icons"),$fraudButton.addEventListener("click",e,!1),ql.subscribe("catalogUpdated",i)}function e(t){t.preventDefault(),t.stopImmediatePropagation(),n(this.href)}function n(t){fetch(t,{method:"PATCH",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(t){return ql.publish("catalogUpdated",t)})["catch"](function(t){return console.log(t)})}function i(t){var e=t.enabled_at?"0":"1",n=t.enabled_at?"check_box":"check_box_outline_blank",i=$enableButton.href.replace(/=\d/i,"="+e);$enableButton.href=i,$enableIcon.innerHTML=n;var o=t.fraud_protection?"0":"1",s=t.fraud_protection?"check_box":"check_box_outline_blank",a=$fraudButton.href.replace(/=\d/i,"="+o);$fraudButton.href=a,$fraudIcon.innerHTML=s}return $enableButton={},$enableIcon={},$fraudButton={},$fraudIcon={},{init:t}}()},initChosenListener=function(){$(".js-chosen").chosen({disable_search_threshold:20})},initChosen=function(){initChosenListener()},ql.focusDataPath="",ql.initStudentCheckBoxListeners=function(){var t=document.querySelectorAll(".js-select-student");[].concat(_toConsumableArray(t)).map(function(t){t.addEventListener("click",ql.handleStudentCheckBox)})},ql.handleStudentCheckBox=function(){ql.toggleStudentRow(this.closest("[data-student]")),ql.toggleStudentCheckBox(this.querySelector("i.material-icons")),ql.toggleActionButtons()},ql.toggleStudentRow=function(t){t.classList.toggle("is-selected")},ql.toggleStudentCheckBox=function(t){t.innerHTML=t.innerHTML.includes("blank")?"check_box":"check_box_outline_blank"},ql.toggleActionButtons=function(){var t=ql.getSelectedStudentRows(),e=t.filter(function(t){return"true"==t.dataset.running}),n=document.querySelector(".js-student-table-title"),i=document.querySelector(".js-student-actions-container"),o=i.querySelectorAll(".mdl-button");t.length?(n.style.display="none",i.style.display="block",0==e.length?o.forEach(function(t){return t.classList.add("mdl-button--disabled")}):o.forEach(function(t){return t.classList.remove("mdl-button--disabled")})):(n.style.display="flex",i.style.display="none")},ql.getSelectedStudentRows=function(){var t=document.querySelectorAll("[data-student]");return[].concat(_toConsumableArray(t)).filter(function(t){return t.classList.contains("is-selected")})},ql.initAddTimeListener=function(){document.querySelector(".js-add-time").addEventListener("click",ql.handleAddTime)},ql.handleAddTime=function(){ql.getSelectedStudentRows().filter(function(t){return"true"==t.dataset.running}).map(function(t){return t.dataset.addTimePath}).map(function(t){var e=new Request(t,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(e).then(status).then(json).then(function(){return ql.getJson(ql.focusDataPath).then(function(t){return ql.publish("received-focus-data",t)})})["catch"](function(t){return console.log("Request failed",t)})})},ql.initEndLabListener=function(){document.querySelector(".js-end-lab").addEventListener("click",ql.handleEndLab)},ql.handleEndLab=function(){ql.getSelectedStudentRows().filter(function(t){return"true"==t.dataset.running}).map(function(t){return t.dataset.endLabPath}).map(function(t){fetch(t,{credentials:"include"}).then(status).then(json).then(function(){return ql.getJson(ql.focusDataPath).then(function(t){return ql.publish("received-focus-data",t)})})["catch"](function(t){return console.log("Request failed",t)})})},ql.trainerClassroomView=function(){function e(t){t.students.forEach(function(t){var e=document.querySelector('[data-student="'+t.id+'"]');(e.dataset.labInstance=t.lab_instance.id,e.dataset.labState=t.lab_instance.lab_state,e.dataset.running=t.lab_instance.running,e.dataset.addTimePath=t.lab_instance.add_time_path,e.dataset.endLabPath=t.lab_instance.end_lab_path,e.querySelector(".js-status").innerHTML=t.lab_instance.status_html,t.lab_instance.score_html)&&(e.querySelector(".js-score").innerHTML=t.lab_instance.score_html)})}function n(t){t.running_hotlabs&&t.running_hotlabs.forEach(function(t){var e=document.querySelector("#focus_"+t.id).querySelector(".js-lab-details");0<t.hotlabs_running_count?e.innerHTML=t.hotlabs_running_count+" labs pre-warmed.":e.innerHTML=""})}function i(t){a&&(a.innerHTML=t.hotlabs_status)}function o(t){r&&(r.innerHTML=t.hotlabs_button)}function s(){ql.getJson(ql.focusDataPath).then(function(t){return ql.publish("received-focus-data",t)}).then(function(){return setTimeout(s,5e3)})["catch"](function(t){return console.log("Request failed",t)})}var a={},r={};return{init:function l(t){ql.focusDataPath=t,a=document.querySelector(".js-hotlabs"),r=document.querySelector(".js-hotlabs-button"),ql.subscribe("received-focus-data",i),ql.subscribe("received-focus-data",o),ql.subscribe("received-focus-data",n),ql.subscribe("received-focus-data",e),s(),document.querySelector("a.classroom__index-item.active").scrollIntoView()}}}(),ql.classroomResourceLabView=function(){function t(t){i=t,o=document.querySelector(".js-classroom-resource-lab"),ql.subscribe("received-resource-lab-data",n),e()}function e(){console.log("Polling Resource Lab Data: "+i),ql.getJson(i).then(function(t){return ql.publish("received-resource-lab-data",t)}).then(function(){return setTimeout(e,5e3)})["catch"](function(t){return console.log("Request failed",t)})}function n(t){o.innerHTML=t.html}var i="",o="";return{init:t}}(),ql.classroomStudentView=function(){function t(t){i=t,o=document.querySelectorAll(".js-focus-row"),ql.subscribe("received-student-data",n),e()}function e(){ql.getJson(i).then(function(t){return ql.publish("received-student-data",t)}).then(function(){return setTimeout(e,5e3)})["catch"](function(t){return console.log("Request failed",t)})}function n(t){t.focuses.forEach(function(e){[].concat(_toConsumableArray(o)).filter(function(t){return t.dataset.focus==e.id}).shift().innerHTML=e.html})}var i="",o="";return{init:t}}();var initClipboardToolTips=function initClipboardToolTips(t){t.on("success",function(t){$(t.trigger).attr("title",trans.copied).tooltip("fixTitle").tooltip("show"),$(t.trigger).mouseout(function(){$(this).tooltip("hide").tooltip("destroy")})}),t.on("error",function(t){var e="";e=/iPhone|iPad/i.test(navigator.userAgent)?trans.no_support:/Mac/i.test(navigator.userAgent)?trans.mac_press:trans.windows_press,$(t.trigger).attr("title",e).tooltip("fixTitle").tooltip("show"),$(t.trigger).mouseout(function(){$(this).tooltip("hide").tooltip("destroy")})})};ql.collaboratorsEdit=function(){function t(){$collaboratorList=$(".js-collaborator-list"),$errorFeedback=$(".js-add-collaborator-error"),e(),n()}function e(){$(".js-add-collaborator-form").on("ajax:before",function(){$errorFeedback.empty()}).on("ajax:success",function(t,e){i(e.rendered)}).on("ajax:error",function(t,e){o(e.responseJSON)})}function n(){$(document).on("ajax:success",".js-collaborator-item",function(t){t.currentTarget.remove(),t.preventDefault()}).on("ajax:error",".js-delete-permission",function(t,e){o(e.responseJSON)})}function i(t){$collaboratorList.append(t),$collaboratorList.scrollTop($collaboratorList[0].scrollHeight),$collaboratorList.find(".mdl-list__item").last().addClass("is-new")}function o(t){errors=t.errors,errors.forEach(function(t){$errorFeedback.append("<p>"+t+"</p>")})}return $collaboratorList="",$errorFeedback="",{init:t}}(),ql.course={schedule:function(){function t(){i=document.querySelectorAll(".js-more-details"),o=document.querySelectorAll(".js-less-details"),i.forEach(function(t){t.addEventListener("click",e,!1)}),o.forEach(function(t){t.addEventListener("click",n,!1)})}function e(t){t.preventDefault(),this.style.display="none",this.parentElement.querySelector(".js-less-details").style.display="block"}function n(t){t.preventDefault(),this.style.display="none",this.parentElement.querySelector(".js-more-details").style.display="block"}var i=undefined,o=undefined;return{init:t}}()};var initCreateAccountButtonListener=function initCreateAccountButtonListener(){$(".js-create-account-button").on("click",function(){console.log("Clicked create account button."),"undefined"!=typeof analytics&&analytics.track("create_account",{})})},initShowSectionButtonListener=function initShowSectionButtonListener(){$(".js-show-section-button").on("click",function(){$(".section_wrapper").css("display","inline"),$(".js-show-section-button").css("display","none")})};ql.discovery=function(){function t(){e(".in-progress-cards .js-content-card","in-progress"),e(".favorite-cards .js-content-card","favorite"),e(".curated-cards .js-content-card","curated"),e(".featured-cards .js-content-card","featured"),e(".upcoming-cards .js-content-card","upcoming"),e(".popular-cards .js-content-card","popular")}function e(t,r){document.querySelectorAll(t).forEach(function(a){a.addEventListener("click",function(){var t=a.dataset,e=t.id,n=t.name,i=t.type,o=t.level,s=t.path;ql.track("discover_catalog_item",{label:r,id:e,name:n,type:i,level:o,path:s})})})}return{init:t}}(),ql.favoriting=function(){function t(){document.querySelectorAll(".js-favorite-button").forEach(function(t){t.addEventListener("click",e,!1)})}function e(t){t.preventDefault(),t.stopImmediatePropagation(),n.call(this),o.call(this)}function n(){var t=i(this.dataset.type),e=this.dataset.name;this.href.includes("unfavorite")?ql.track("clicked_unfavorite_button",{type:t,label:e}):ql.track("clicked_favorite_button",{type:t,label:e})}function i(t){var e=undefined;switch(t){case"CatalogItem":e="Lab";break;case"LearningPath":e="Quest";break;case"ClassroomTemplate":e="Course";break;default:cateogry=t}return e}function o(){var e=this,t=new Request(this.href,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(t).then(status).then(json).then(function(t){console.log(t),t.alert?console.error(t.alert):(e.href=t.path,e.querySelector("i").innerHTML=t.icon,e.nextElementSibling.innerHTML=t.tooltip,$card=e.closest(".js-content-card"),$card&&$card.classList.toggle("is-unfavorited"))})}return{init:t}}(),ql.game=function(){function t(t){var e=document.querySelector(".js-lab-leaderboard");null!=t&&null!=e&&(e.players=JSON.parse(t))}return{updateLabLeaderboard:t}}(),ql.initHeader=function(){$(".js-header-search-bar-button").click(function(){$(".js-header-search-bar").addClass("is-open"),$(".js-header-search-bar input").focus()}),$(".js-header-search-bar .mdl-button").click(function(){$(".js-header-search-bar").removeClass("is-open")})},ql.catalogSearchFilter=function(){var t=document.querySelector("#catalog-filter-form"),e=document.querySelector(".js-header-search-bar.is-open")?document.querySelector("#catalog-search-mobile"):document.querySelector("#catalog-search");return t?(t.querySelector("#keywords").value=e.querySelector("#keywords").value,t.querySelector("#locale").value=e.querySelector("#locale").value,t.submit()):e&&e.submit(),!1},ql.header={myAccount:function(){function t(){n=document.querySelector(".js-my-account-menu"),i=document.querySelector(".js-main"),n&&($myAccountButton=document.querySelector(".js-my-account-button"),$myAccountButton.addEventListener("click",e,!1))}function e(){n.classList.toggle("is-open")?(ql.track("opened_my_account_menu"),i.addEventListener("click",e,!1)):i.removeEventListener("click",e,!1)}var n=undefined,i=undefined;return{init:t}}()},function(n){function i(t,e){this.instructionId=t,this.refreshPage=e,this.refreshing=!1,this.refresh=function(){var e=this;this.refreshing?console.log("Already polling. Ignoring this refresh."):(this.startRefreshing(),$.post("/authoring/instructions/"+this.instructionId+"/refresh.json").done(function(){setTimeout(function(){return e.pollStatus()},2e3)}).fail(function(t){console.log(t),e.stopRefreshing()}))},this.pollStatus=function(){var e=this;n.getJson("/instructions/"+this.instructionId+"/status.json").then(function(t){"failed"==t.state?(n.showFlash("error",t.message),e.stopRefreshing()):"completed"==t.state?(n.showFlash("notice",t.message),e.refreshPage?window.location.reload():e.stopRefreshing()):setTimeout(function(){return e.pollStatus()},5e3)})["catch"](function(t){e.stopRefreshing(),console.log(t)})},this.startRefreshing=function(){var t=this.instructionId;this.refreshing=!0,$(".refresh-instruction-spinner-"+t).removeClass("hidden"),$(".refresh-instruction-button-"+t).addClass("hidden")},this.stopRefreshing=function(){var t=this.instructionId;this.refreshing=!1,$(".refresh-instruction-spinner-"+t).addClass("hidden"),$(".refresh-instruction-button-"+t).removeClass("hidden")}}n.refreshInstruction=function(t,e){new i(t,e).refresh()}}(ql),ql.jupyter={startListener:function(){function t(){var t=document.querySelector("ql-jupyter-notebook"),e=document.querySelector(".button--start");e&&e.addEventListener("click",function(){e.setAttribute("disabled","disabled"),e.closest(".js-start-panel").classList.add("is-hidden"),t.loading=!0},!1)}return{init:t}}(),endListener:function(){function t(){var t=document.querySelector(".button--end");t&&t.addEventListener("click",function(){t.setAttribute("disabled","disabled")},!1)}return{init:t}}(),poller:function(){function t(t){i=document.querySelector("ql-jupyter-notebook"),new ql.Poller(t,3e3,e,n).start()}function e(t){if(console.log("polled!",t),(t.isExpired||t.errors)&&n(),t.provisioning||(i.labInstanceId=t.labInstanceId),t.labTimer.ticking){var e=t.labTimer.secondsRemaining;hours=Math.floor(e/3600),e%=3600,minutes=Math.floor(e/60),seconds=e%60,displayTimer=hours+"hr "+minutes+"m",document.querySelector(".js-timer").innerHTML=displayTimer}}function n(){document.querySelector(".button--end").click()}undefined;var i=undefined;return{init:t}}(),activityTracking:function(){function t(){document.querySelectorAll(".js-verify").forEach(function(t){t.addEventListener("click",e,!1)})}function e(t){var e=this;t.preventDefault();var n=this.dataset.step;ql.getJson(this.href).then(function(t){t.step_complete[n]&&e.closest(".js-checkpoint").classList.add("is-complete"),hallofmirrors.snackbarService.alert(t.messages[n])})}return{init:t}}()},initLaunchWithSubscriptionButtonListener=function(){$(".js-launch-with-subscription-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(0),$(".js-launch-with-subscription-input").val(1),submitLabAccessForm())})},initLaunchWithCreditsButtonListener=function(){$(".js-launch-with-credits-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(1),$(".js-launch-with-subscription-input").val(0),submitLabAccessForm())})},initLaunchWithAccessCodeButtonListener=function(){$(".js-launch-with-access-code-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(0),$(".js-launch-with-subscription-input").val(0),submitLabAccessForm())})},initLabAccessFormListener=function(){$(".js-lab-access-form").on("ajax:success",function(){launchLab()}).on("ajax:error",function(t,e){$(".js-access-code input").val(""),alertLabAccessError(e.responseText)}).on("ajax:complete",function(){enableLabAccessModalButtons()})},submitLabAccessForm=function(){ql.labControlPanel.setStarting(),disableLabAccessModalButtons(),$(".js-lab-access-form").submit()},launchLab=function(){$("#lab-access-modal").modal("hide"),ql.labRun.startLab({justPaid:!0})},alertLabAccessError=function(t){$("#lab-access-modal").modal("hide"),$(".js-alert-message").html(t),$(".js-alert").removeClass("alert-success").addClass("alert-error").css("display","flex")},disableLabAccessModalButtons=function(){$(".js-lab-access-modal-button").attr("disabled",!0)},enableLabAccessModalButtons=function(){$(".js-lab-access-modal-button").attr("disabled",!1)},initLabAccessModal=function(){initLaunchWithSubscriptionButtonListener(),initLaunchWithCreditsButtonListener(),initLaunchWithAccessCodeButtonListener(),initLabAccessFormListener()},ql.labAlert={alertMessage:function Of(t){$(".js-alert-message").html(t),$(".js-alert").removeClass("alert-success").addClass("alert-error").css("display","flex")},alertHttpError:function Pf(t){t.response.text().then(function(t){ql.labAlert.alertMessage(t)})}},ql.labAssessment=function(){var n=function n(t,e){$.get("/assessments/run_step.json?id="+t+"&step="+e).done(function(t){ql.labAssessment.update(t),int_no=parseInt(e)-1,t.completion_only?t.step_scores[int_no]==t.step_points[int_no]?alert("Step is complete. "):alert("Step is incomplete."):alert("Check complete.\n        Points earned: "+t.step_scores[int_no]+"\n        Message: "+t.student_messages[int_no])}).fail(function(){alert("Failed to update assessment")})};return{init:function t(){$(".js-lab-assessment-tab").click(function(){$(".js-lab-assessment-tab").toggleClass("is-open"),$(".js-lab-assessment-panel").toggleClass("is-open")}),$(".js-show-run-step-button").on("click",function(){var t=ql.labData.getLabInstanceId(),e=$(this).attr("step_no");t!==undefined&&ql.labData.isRunning()&&n(t,e)})},update:function o(t){if(void 0!==t&&"undefined"!=typeof t.total_score&&0!==t.total_score.length){var e="";for(e=t.completion_only?t.completed_steps+"/"+t.total_steps:t.total_score+"/"+t.perfect_score,$(".js-lab-assessment-total-score").html(e),i=1;i<=parseInt(t.total_steps);i++)t.completion_only?t.step_complete[i-1]?($(".js-assessment-step-score-"+i+" i:first-child").addClass("fa-check"),$(".js-assessment-step-score-"+i+" i:first-child").removeClass("fa-times")):($(".js-assessment-step-score-"+i+" i:first-child").addClass("fa-times"),$(".js-assessment-step-score-"+i+" i:first-child").removeClass("fa-check")):$(".js-assessment-step-score-"+i).html(t.step_scores[i-1])}},reset:function e(){var t=$(".js-lab-assessment-total-score").html();void 0!==t&&(t=t.replace(/.*\//,"\u2014/"),$(".js-lab-assessment-total-score").html(t),$('*[class^="js-assessment-step-score"]').html("\u2014"))}}}();var t="";initFakeAlertCloseListener=function(){$(".js-alert-close").click(function(){$(".js-alert").hide()})},initCopyCode=function(){$("pre code").each(function(e,t){$(t).after('<button class="button button--copy js-copy-button-'+e+'"><i class="fa fa-clipboard"></i></button>');var n=document.getElementsByClassName("no-select")[0],i=new Clipboard(".js-copy-button-"+e,{target:function o(t){return n&&n.classList.remove("no-select"),t.previousElementSibling}});i.on("success",function(){n&&n.classList.add("no-select"),document.getSelection().removeAllRanges(),$(".js-copy-button-"+e).attr("title",trans.copied).tooltip("fixTitle").tooltip("show")}),i.on("error",function(){n&&n.classList.add("no-select"),document.getSelection().removeAllRanges();var t="";t=/iPhone|iPad/i.test(navigator.userAgent)?trans.no_support:/Mac/i.test(navigator.userAgent)?trans.mac_press:trans.windows_press,$(".js-copy-button-"+e).attr("title",t).tooltip("fixTitle").tooltip("show")}),$(".js-copy-button-"+e).mouseout(function(){$(this).tooltip("hide").tooltip("destroy")})})},initImageZoom=function(){$(".js-lab-content img").click(function(){var t=$(this).attr("src");$("body").append('<div class="lab-content__image-overlay js-zoomed-image"><img class="lab-content__image" src='+t+" /></div>").find(".js-zoomed-image").click(function(){$(".js-zoomed-image").remove()})})},initPrettyPrint=function(){$(function(){prettyPrint()})},initCodeTabs=function(){var t=Array.from(document.querySelectorAll("ql-code"));t.forEach(function(n){return n.addEventListener("tabchange",function(e){return t.filter(function(t){return t!==n}).forEach(function(t){return t.setLanguage(e.detail.newTab.language)})})})},initLabContent=function(){initFakeAlertCloseListener(),initCopyCode(),initImageZoom(),initPrettyPrint(),initCodeTabs()},ql.labControlPanel=function(){var e=undefined;return{init:function t(){(e=document.querySelector(".js-lab-control-panel")).addEventListener("clickedStartLab",function(){return ql.labRun.startLab({justPaid:!1})}),e.addEventListener("clickedStopLab",function(){window.confirm(trans.are_you_sure)&&ql.labRun.stopLab()})},update:function n(t){e.labControlButton=t.labControlButton,e.labTimer=t.labTimer,e.billingLimitRemainder=t.billingLimitRemainder,e.provisioning=t.provisioning,e.provisioningSecondsRemaining=t.provisioningSecondsRemaining,e.openConsoleButton=t.consoleButton,e.connectionDetails=t.connectionDetails,e.connectionFiles=t.connectionFiles},reset:function i(){e.labControlButton={running:!1,pending:!1},e.billingLimitRemainder=ql.labData.getLabBillingLimit(),e.provisioning=!1,e.provisioningSecondsRemaining=null,e.openConsoleButton=null,e.connectionDetails=[],e.connectionFiles=[],e.labTimer={ticking:!1,secondsRemaining:ql.labData.getLabDuration()}},setStarting:function o(){e.labControlButton={running:!1,pending:!0}},setStopping:function s(){e.labControlButton={running:!0,pending:!0}},setRunning:function a(){e.labControlButton={running:!0,pending:!1}}}}(),ql.labData=function(){var t=undefined,e=undefined;return{clearLabInstanceId:function n(){e=null},getLabInstanceId:function i(){return e},setLabInstanceId:function o(t){e=t},getAnalyticsPayload:function s(){return t.analyticsPayload},getLabBillingLimit:function a(){return Number(t.labBillingLimit)},getLabDuration:function r(){return Number(t.labDuration)},getFocusId:function l(){return t.focusId},getParent:function c(){return t.parent},getQlcampaign:function u(){return t.qlcampaign},isPaymentRequired:function d(){return null!=t.paymentRequired},isRunning:function f(){return null!=e},init:function m(){t=$(".js-lab-state").data(),e=t.labInstanceId}}}(),ql.editRows=function(){
function t(){s=document.querySelectorAll(".js-edit-row"),a=document.querySelector(".js-edit-title"),r=[a].concat(_toConsumableArray(s)),s.forEach(function(t){return t.addEventListener("click",n)}),a.addEventListener("click",o),$errorFields=document.querySelectorAll(".has-error"),$errorFields.forEach(function(t){$row=t.closest(".js-edit-row"),i($row)}),$inputs=document.querySelectorAll(".js-lab-details input"),$inputs.forEach(function(t){t.addEventListener("keyup",e)})}function e(){$editRow=this.closest(".js-edit-row"),this.checkValidity()?$editRow.classList.remove("is-invalid"):$editRow.classList.add("is-invalid")}function n(){if(!this.classList.contains("is-selected")){o(),i(this);var t=this.querySelectorAll("input"),e=this.querySelectorAll("select"),n=this.querySelectorAll("textarea");n[0]?n[0].focus():e[0]?e[0].focus():t[0]&&t[0].focus()}}function i(t){var e=r.indexOf(t);r[e].classList.add("is-selected"),r[e].style.height=t.scrollHeight+24+"px",r[e-1]&&r[e-1].classList.add("is-bottom"),r[e+1]&&r[e+1].classList.add("is-top")}function o(){r.forEach(function(t){t.classList.remove("is-selected"),t.classList.remove("is-bottom"),t.classList.remove("is-top"),t.style.height="64px"})}var s="",a="",r=[];return{init:t}}(),ql.additionalResources=function(){function t(){$(document).on("nested:fieldAdded",e),$(document).on("nested:fieldRemoved",n)}function e(t){$editRow=t.target.closest(".js-edit-row"),$editRow.style.height=$editRow.scrollHeight+16+"px",ql.initMaterialInputs($editRow)}function n(t){$editRow=t.target.closest(".js-edit-row"),$editRow.style.height=$editRow.scrollHeight-i-16+"px"}var i=122;return{init:t}}(),ql.deploymentManager=function(){function t(){n=document.querySelector(".js-dm"),i=document.querySelector(".js-remove-dm-button"),o=document.querySelector(".js-remove-dm"),i.addEventListener("click",e)}function e(){n.href="",n.style.color="red",n.style.fontWeight="400",n.style.textDecoration="line-through",o.value=1,i.remove()}var n="",i="",o="";return{init:t}}(),ql.cloudFormation=function(){function t(){n=document.querySelector(".js-cf"),i=document.querySelector(".js-remove-cf-button"),o=document.querySelectorAll(".js-remove-cf"),i.addEventListener("click",e)}function e(){n.href="",n.style.color="red",n.style.fontWeight="400",n.style.textDecoration="line-through",o.forEach(function(t){return t.value=""}),i.remove()}var n="",i="",o="";return{init:t}}(),ql.studentPolicy=function(){function t(){n=document.querySelector(".js-sp"),i=document.querySelector(".js-remove-sp-button"),o=document.querySelectorAll(".js-remove-sp"),i.addEventListener("click",e)}function e(){n.href="",n.style.color="red",n.style.fontWeight="400",n.style.textDecoration="line-through",o.forEach(function(t){return t.value=""}),i.remove()}var n="",i="",o="";return{init:t}}(),ql.instruction=function(){function t(){$instructionContent=document.querySelector(".js-instruction-content"),$instructionHeader=document.querySelector(".js-instruction-header"),$instructionLoader=document.querySelector(".js-instruction-loader"),$instructionRefresh=document.querySelector(".js-instruction-refresh"),ql.subscribe("received-instruction-status",o),$instructionRefresh&&$instructionRefresh.addEventListener("click",e,!1)}function e(t){t.stopImmediatePropagation(),t.preventDefault(),$instructionContent.classList.add("is-faded"),$instructionLoader.classList.remove("is-hidden");var e=new Request(this.href,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(e).then(status).then(json).then(function(t){return n(t.status_path)})["catch"](a)}function n(t){instructionPoller=new ql.Poller(t,1e3,i,a),instructionPoller.start()}function i(t){ql.publish("received-instruction-status",t)}function o(t){"completed"==t.state&&(instructionPoller.stop(),ql.getHtml(t.display_path).then(s)["catch"](a))}function s(t){$instructionContent.innerHTML=t,$instructionContent.classList.remove("is-faded"),$instructionContent.classList.remove("is-hidden"),$instructionHeader.classList.remove("has-error"),$instructionLoader.classList.add("is-hidden")}function a(t){var e="Response not a JSON";"string"==typeof t?t.json().then(function(t){e=t.errors}):e=t.statusText,htmlSafeMessage=$("<div>").text(e).html(),$instructionContent.innerHTML="<div class='lab__instructions__error'>\n        <i class='material-icons'>error_outline</i>\n        <p>"+htmlSafeMessage+"</p>\n      </div>",$instructionContent.classList.remove("is-faded"),$instructionContent.classList.remove("is-hidden"),$instructionHeader.classList.add("has-error"),$instructionLoader.classList.add("is-hidden")}return $instructionCard="",$instructionContent="",$instructionHeader="",$instructionLoader="",$instructionRefresh="",instructionPoller={},{init:t,poll:n}}(),ql.downloadLab=function(){function t(){function t(){e.setAttribute("disabled","disabled"),e.querySelector("i").innerText="checkmark"}var e=document.getElementById("file_download-header");null!==e&&e.addEventListener("click",t)}return{init:t}}(),ql.publishLab=function(){function t(){$publishButton=document.querySelector(".js-publish-button"),$toast=document.querySelector(".js-toast"),$toastMessage=document.querySelector(".js-toast-message"),$toastLoader=$toast.querySelector(".mdl-js-progress"),ql.subscribe("received-publish-status",o),$publishButton.addEventListener("click",e)}function e(t){t.preventDefault();var e=new Request(this.href,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(e).then(status).then(json).then(function(t){return n(t.status_path)})["catch"](console.error)}function n(t){publishPoller=new ql.Poller(t,500,i),publishPoller.start()}function i(t){ql.publish("received-publish-status",t)}function o(t){"done"==t.status||"error"==t.status?(publishPoller.stop(),$toastLoader.classList.remove("is-visible"),$toastMessage.innerHTML=t.html):$toastLoader.classList.contains("is-visible")||($toastLoader.classList.add("is-visible"),$toastMessage.innerHTML=t.html),"error"===t.status?(ql.showFlash("warn",t.html),$toast.classList.remove("is-visible")):$toast.classList.add("is-visible")}return $publishButton="",$toast="",$toastMessage="",$toastLoader="",publishPoller={},{init:t,poll:n}}(),ql.labLocale=function(){function t(){$newLocaleButton=document.querySelector(".js-new-locale"),$dialog=document.querySelector(".js-dialog"),$localeDialogBody=$dialog.querySelector(".js-new-lab-locale"),localeDialog=new ql.MaterialDialog($dialog),$newLocaleButton.addEventListener("click",e)}function e(t){t.preventDefault(),ql.getHtml(this.href).then(n).then(i)["catch"](console.error)}function n(t){$localeDialogBody.innerHTML=t,ql.initMaterialInputs($localeDialogBody),localeDialog.open()}function i(){$(document).on("ajax:success","form",function(t,e,n,i){$(document).off("ajax:success"),localeDialog.close(),window.location.replace(i.responseJSON.url)}).on("ajax:error","form",function(t,e,n,i){console.error(i)})}return $dialog="",$newLocaleButton="",$localeDialogBody="",localeDialog={},{init:t}}(),ql.tagSelect=function(){function t(){n=document.querySelector(".js-chosen-tags").closest(".js-edit-row"),$(".js-chosen-tags").chosen().change(e)}function e(){$chosenContainers=n.querySelectorAll(".chosen-container");var e=293;$chosenContainers.forEach(function(t){e+=t.offsetHeight}),n.style.height=e+"px"}var n=undefined;return{init:t}}(),ql.permissionsSelect=function(){function t(){r=document.querySelector(".js-permissions-advanced-link"),a=document.querySelector(".js-chosen-permissions"),(s=document.querySelector(".js-permissions-input")).addEventListener("change",n),r.addEventListener("click",i),$(".js-chosen-permissions").chosen().change(e)}function e(){var t=[].concat(_toConsumableArray(this.selectedOptions)).map(function(t){return t.value}).join("\r\n");s.value=t,o()}function n(){this.classList.contains("is-visible")&&([].concat(_toConsumableArray(a.querySelectorAll("option"))).forEach(function(t){return t.selected=!1}),this.value.split("\n").forEach(function(t){var e=a.querySelector("[value='"+t+"']");e&&(e.selected=!0)}),$(".js-chosen-permissions").trigger("chosen:updated"));o()}function i(){s.classList.toggle("is-visible"),$chosen=document.querySelector(".js-permissions .chosen-container"),$chosen.classList.toggle("is-hidden"),$editRow=this.closest(".js-edit-row"),$editRow.classList.toggle("is-advanced"),newLabel=this.dataset.label,oldLabel=this.innerText,this.setAttribute("data-label",oldLabel),this.innerText=newLabel,o()}function o(){$chosen=document.querySelector(".js-permissions .chosen-container"),h=$chosen.offsetHeight,$editRow=$chosen.closest(".js-edit-row"),$editRow.style.height=h+114+"px"}var s="",a="",r="";return{init:t}}(),ql.disableLab=function(){function t(){$disableButton=document.querySelector(".js-disable-lab"),$disableIcon=$disableButton.querySelector(".material-icons"),$disableButton.addEventListener("click",e,!1),$disableNotice=document.querySelector(".js-disable-notice"),ql.subscribe("labUpdated",i)}function e(t){t.preventDefault(),t.stopImmediatePropagation(),n(this.href)}function n(t){fetch(t,{method:"PATCH",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(t){return ql.publish("labUpdated",t)})["catch"](function(t){return console.log(t)})}function i(t){var e=t.disabled_for_catalogs_at?"disable":"enable",n=t.disabled_for_catalogs_at?"enable":"disable",i=t.disabled_for_catalogs_at?"check_box":"check_box_outline_blank",o=$disableButton.href.replace(e,n);$disableButton.href=o,$disableIcon.innerHTML=i,t.disabled_for_catalogs_at?$("#modal_disable").modal("show"):$disableNotice.remove()}return $disableButton={},$disableIcon={},$disableNotice={},{init:t}}(),ql.labIndexView=function(){function t(){(n=[].concat(_toConsumableArray(document.querySelectorAll(".js-lab-row")))).length&&(n[i].focus(),window.addEventListener("keyup",e))}function e(t){"ArrowDown"===t.key?n[i+1]&&n[++i].focus():"ArrowUp"===t.key&&n[i-1]&&n[--i].focus()}var n=[],i=0;return{init:t}}(),ql.labInlineInstructionComponents=function(){var t=["ql-activity-tracking","ql-multiple-choice-probe","ql-multiple-select-probe","ql-true-false-probe"].join(", ");return{updateLabInstanceId:function e(){$(t).attr("labInstanceId",ql.labData.getLabInstanceId())}}}(),ql.labIntroduction=function(){function t(t){window.YT&&(r=document.querySelector(".js-lab-introduction"))&&(r.addEventListener("transitionend",s,!1),document.querySelectorAll(".js-skip-button").forEach(function(t){return t.addEventListener("click",i,!1)}),localStorage.getItem("labIntroViewed")||t||e(),YT.ready(function(){a=new YT.Player("lab-introduction",{events:{onReady:function t(){},onStateChange:n}})}))}function e(){r.classList.remove("is-hidden"),r.classList.remove("is-invisible")}function n(t){t.data===YT.PlayerState.ENDED&&o()}function i(){o(),a&&a.pauseVideo()}function o(){r.classList.add("is-invisible"),localStorage.setItem("labIntroViewed",!0)}function s(t){t.target==r&&"opacity"==t.propertyName&&t.target.classList.add("is-hidden")}var a=undefined,r=undefined;return{init:t}}(),ql.labOutline={links:function(){function t(){s=document.querySelector(".js-lab-content"),r=s.querySelectorAll("h2"),a=s.querySelector(".js-lab-content-outline"),(l=a.querySelectorAll("a")).forEach(function(t){return t.addEventListener("click",e)}),window.addEventListener("scroll",i)}function e(t){t.preventDefault(),ql.track("clicked_lab_outline",{label:t.target.innerText});var e=t.target.getAttribute("href"),n=s.querySelector(e);n&&$("html, body").animate({scrollTop:n.offsetTop+o()-c},500,function(){t.target.blur(),i()})}function i(){requestAnimationFrame(function(){var e=window.scrollY-o()+u,t=[].concat(_toConsumableArray(r)).filter(function(t){return t.offsetTop<=e});n(t.length?t.pop():null)})}function n(t){(l.forEach(function(t){return t.classList.remove("is-active")}),null!=t)&&a.querySelector("a[href='#"+t.id+"']").classList.add("is-active")}function o(){return document.querySelector(".lab-content__inner-wrapper").offsetTop}var s=undefined,a=undefined,r=undefined,l=undefined,c=80,u=300;return{init:t}}(),layout:function(){function t(){n=document.querySelector(".js-lab-content-outline"),i=document.querySelector(".lab-content__inner-wrapper").offsetTop,window.addEventListener("scroll",e,!1),e()}function e(){requestAnimationFrame(function(){window.scrollY>i-o?n.classList.add("is-stuck"):n.classList.remove("is-stuck")})}var n=undefined,i=undefined,o=200;return{init:t}}()};var initRateItListener=function initRateItListener(){$(".js-rateit").bind("rated",function(t,e){setRating(e),$("#submit").data("disabled")||$("#submit").prop("disabled",!1)})},initReviewSubmitListener=function initReviewSubmitListener(){$(".js-lab-review-form").on("ajax:success",function(t,e,n,i){alertLabReviewSuccess(i)}).on("ajax:error",function(t,e){alertLabReviewError(e.responseText)})},alertLabReviewSuccess=function alertLabReviewSuccess(){$("#lab-review-modal").modal("hide"),$(".js-alert-message").html(trans.thanks_review),$(".js-alert").removeClass("alert-error").addClass("alert-success").css("display","flex")},alertLabReviewError=function alertLabReviewError(t){message=JSON.parse(t).message,$("#lab-review-modal").modal("hide"),$(".js-alert-message").html(message),$(".js-alert").removeClass("alert-success").addClass("alert-error").css("display","flex")},setRating=function setRating(t){$(".js-rating-input").val(t-3)},initLabReviewModal=function initLabReviewModal(){initRateItListener(),initReviewSubmitListener()};ql.labRun=function(){function t(){i=new hallofmirrors.lab.LabInstancePoller({labRunnerId:ql.labData.getFocusId(),labContainerType:ql.labData.getParent(),successCallback:function e(t){t.isExpired?ql.labRun.stopLab():(ql.labData.setLabInstanceId(t.labInstanceId),ql.labAssessment.update(t.assessmentInfo),ql.game.updateLabLeaderboard(t.gameLeaderboard),ql.labInlineInstructionComponents.updateLabInstanceId(),ql.labControlPanel.update(t))},errorCallback:function n(t){console.error("Lab poll error: ",t)}})}var i=undefined;return{init:function e(){ql.labControlPanel.init(),t(),ql.labData.isRunning()&&i.start()},startLab:function n(t){var e=t.justPaid;e||ql.track("clicked_start_lab_button",ql.labData.getAnalyticsPayload()),!ql.labData.isPaymentRequired()||e?(ql.labControlPanel.setStarting(),ql.labXhr.startLab().then(function(t){t.message&&hallofmirrors.snackbarService.alert(t.message),ql.track("lab_started",ql.labData.getAnalyticsPayload()),i.start()})["catch"](function(t){ql.labControlPanel.reset(),ql.labAlert.alertHttpError(t)})):$("#lab-access-modal").modal("show")},stopLab:function o(){ql.labControlPanel.setStopping(),ql.track("clicked_end_lab_button",ql.labData.getAnalyticsPayload()),ql.labXhr.stopLab().then(function(t){var e=t.runtime_error;ql.labData.clearLabInstanceId(),i.stop(),ql.labControlPanel.reset(),ql.labAssessment.reset(),e?ql.labAlert.alertMessage(e):$("#lab-review-modal").modal("show")})["catch"](function(t){ql.labAlert.alertHttpError(t),ql.labControlPanel.setRunning()})}}}(),ql.labXhr={startLab:function Jk(){return hallofmirrors.lab.labHttpService.startLab({labRunnerId:ql.labData.getFocusId(),labContainerType:ql.labData.getParent(),qlcampaign:ql.labData.getQlcampaign()})},stopLab:function Kk(){return hallofmirrors.lab.labHttpService.endLab({labInstanceId:ql.labData.getLabInstanceId()})}},ql.list=function(){function t(){document.querySelectorAll(".js-list-item").forEach(function(t){$expandToggle=t.querySelector(".js-list-item-expand"),$expandToggle.addEventListener("click",e,!1)})}function e(){$listItem=this.closest(".js-list-item"),$listItemDetails=$listItem.querySelector(".js-list-item-details"),$listItem.classList.toggle("is-expanded");var t=this.offsetHeight+$listItemDetails.offsetHeight;$listItem.style.height=t+"px"}return{init:t}}(),ql.MaterialDialog=function(t,e){this.dialog=t,this.dismissers=$(this.dialog).find("[data-dismiss]"),this.isOpen=e||!1,this.listen(),this.upgrade(),this.render()},ql.MaterialDialog.prototype.upgrade=function(){$(this.dialog).addClass("is-upgraded")},ql.MaterialDialog.prototype.listen=function(){for(var t=0;t<this.dismissers.length;t++)this.dismissers[t].addEventListener("click",this.close.bind(this))},ql.MaterialDialog.prototype.close=function(){this.isOpen=!1,this.render()},ql.MaterialDialog.prototype.open=function(){this.isOpen=!0,this.render()},ql.MaterialDialog.prototype.render=function(){this.isOpen?$(this.dialog).addClass("is-open"):$(this.dialog).removeClass("is-open")},ql.MaterialInput=function(t){this.input=t,this.wrapper=this.input.parentElement.parentElement,this.isFilled=!!this.input.value,this.isValid=!0,this.listen(),this.upgrade()},ql.MaterialInput.prototype.listen=function(){this.input.addEventListener("input",this.setAndRender.bind(this)),this.input.addEventListener("blur",this.setAndRender.bind(this))},ql.MaterialInput.prototype.upgrade=function(){$(this.input).addClass("is-upgraded")},ql.MaterialInput.prototype.setAndRender=function(){this.setAttributes(),this.isFilled?$(this.input).addClass("is-filled"):$(this.input).removeClass("is-filled"),this.isValid?$(this.wrapper).removeClass("has-error"):$(this.wrapper).addClass("has-error")},ql.MaterialInput.prototype.setAttributes=function(){this.setIsFilled(),this.setIsValid()},ql.MaterialInput.prototype.setIsFilled=function(){this.isFilled=!!this.input.value},ql.MaterialInput.prototype.setIsValid=function(){this.isValid=this.input.validity.valid},ql.initMaterialInputs=function(t){if((t=t||[]).length)var e=t.find(".md-input__input");else e=document.getElementsByClassName("md-input__input");for(var n=0;n<e.length;n++)$(e[n]).hasClass("is-upgraded")||new ql.MaterialInput(e[n])},ql.modals=function(){function t(){$(".modal[data-show]").modal("show"),$(".modal[data-modal-shown-path]").on("show.bs.modal",function(){$.get(this.dataset.modalShownPath)}).modal("show")}return{init:t}}(),ql.navPanel=function(){function t(){n=document.querySelector(".js-nav-panel"),document.querySelectorAll(".js-nav-toggle").forEach(function(t){return t.addEventListener("click",e)})}function e(t){t.preventDefault(),n.classList.toggle("is-open"),ql.track("Side navigation toggled",{category:"Navigation"})}var n=undefined;return{init:t}}(),ql.navigation=function(){function t(){document.querySelectorAll(".js-navigation-button").forEach(function(t){t.addEventListener("click",e,!1)})}function e(){ql.track("Navigation link clicked",{category:"Navigation",label:this.title})}undefined;return{init:t}}(),ql.initNewLabWindowListener=function(){$(window).resize(function(){ql.setHorizontal()})},ql.setHorizontal=function(){$(window).width()<600?($(".md-input").removeClass("md-input--horizontal"),$(".js-permissions-select").removeClass("permissions-select__container--horizontal"),$(".js-labs-resources").removeClass("labs__resources--horizontal")):($(".md-input").addClass("md-input--horizontal"),$(".js-student-resources .md-input").removeClass("md-input--horizontal"),$(".js-permissions-select").addClass("permissions-select__container--horizontal"),$(".js-labs-resources").addClass("labs__resources--horizontal"))},ql.initNewStudentResourceListener=function(){$(document).on("nested:fieldAdded",function(t){for(var e=t.field.find(".md-input__input"),n=0;n<e.length;n++)new ql.MaterialInput(e[n])})},ql.initInstructionRemovedListener=function(){$(document).on("nested:fieldRemoved",function(t){t.field.next(".js-add-instruction").click()})};var initNewLab=function initNewLab(){ql.setHorizontal(),ql.initNewLabWindowListener(),ql.initNewStudentResourceListener(),ql.initInstructionRemovedListener()};ql.initNewLabLocale=function(){ql.initNewLabLocaleButtonListener(),ql.initNewLabLocaleSubmitListener()},ql.initNewLabLocaleButtonListener=function(){$(".js-new-lab-locale-button").on("ajax:success",function(t,e,n,i){$(".js-new-lab-locale").html(i.responseText),ql.initMaterialInputs($(".js-new-lab-locale")),ql.newLabLocaleDialog=new ql.MaterialDialog($(".js-dialog"),!0)})},ql.initNewLabLocaleSubmitListener=function(){$(document).on("ajax:success","form",function(t,e,n,i){ql.newLabLocaleDialog.close(),$(".js-lab-locales-table").find(".flex-table__row:nth-child(1)").after(i.responseText),$(".js-lab-locales-table").find(".flex-table__row:nth-child(2)").addClass("is-new")}).on("ajax:error","form",function(){console.log("aww")})},ql.pagination=function(){function t(){e(),n()}function e(){o=document.querySelectorAll(".js-pagination select")}function n(){o.forEach(function(t){t.addEventListener("change",i)})}function i(t){t.preventDefault(),this.closest("form")?this.closest("form").submit():window.location.search+="&per_page="+this.value}var o="";return{init:t}}();var initPaymentsPage=function initPaymentsPage(){$(".js-purchase-option").first().prop("checked",!0)},initRadioButtonListener=function initRadioButtonListener(){$(".js-purchase-option").change(function(){$(".js-purchase-option").siblings(".js-purchase-option-details").removeClass("is-selected"),$(this).siblings(".js-purchase-option-details").addClass("is-selected"),updateTotal(),$(this).hasClass("js-other-credit")||$(".js-other-credit").prop("disabled",!0)})},initOtherRadioButtonListener=function initOtherRadioButtonListener(){$(".js-other-option").change(function(){$(".js-other-credit").prop("disabled",!1).focus()})},initOtherInputListener=function initOtherInputListener(){$(".js-other-credit").on("keyup mouseup change",function(){$(".js-other-option").val($(this).val()),updateTotal()})},initAddPromoCodeButtonListener=function initAddPromoCodeButtonListener(){$(".js-add-promo-code-button").click(function(t){t.preventDefault();var e=$(".js-purchase-option:checked"),n=e.val().trim(),i=e.data("product-code"),o=$(".js-promo-code").val().trim(),s=$(".js-payments-paths").data("validate-promo-code-path");if(null==o||") && (quantity == null || quantity == "==o)return!1;$.get(s,{uuid:o,credits:n,product_code:i},null,"html").success(function(t){$(".js-payment-details").html(t),$("#payment_details_modal").modal("show"),initRedeemPromoCodeButtonListener(),updateTotal()})})},initRedeemPromoCodeButtonListener=function initRedeemPromoCodeButtonListener(){$("#redeem_now").click(function(){redeemNowUrl=$(".js-payments-paths").data("redeem-now-path"),promoCode=$(".js-promo-code").val().trim(),$.post(redeemNowUrl,{uuid:promoCode}).fail(function(t){alert("Redeem call failed: "+t.responseText)}).done(function(t){window.location.href=t})})},updateTotal=function updateTotal(){var t=$(".js-purchase-option:checked"),e=t.val().trim(),n=t.data("product-code"),i=$(".js-promo-code").val().trim(),o=t.data("course-id"),s=$(".js-payments-paths").data("calculate-total-path");$.get(s,{quantity:e,product_code:n,promo_code:i,course_id:o},null,"json").success(function(t){t.full_price.subtotal?($(".js-payment-sub-total").html(t.full_price.subtotal),$(".js-payment-tax").html(t.full_price.tax),$(".js-payment-total").html(t.full_price.total)):$(".js-payment-total").html(t.price),$(".js-payment-total").data("price_in_cents",t.price_in_cents)})},initStripeButton=function initStripeButton(){if($(".js-stripe-button").length){var r=$(".js-stripe-button").data("currency"),t="usd"===r||"cny"===r,l=StripeCheckout.configure({key:$(".js-stripe-button").data("key"),currency:$(".js-stripe-button").data("currency"),alipay:t,locale:"auto",token:function c(t){var e=$(".js-purchase-option:checked"),n=e.val().trim(),i=e.data("product-code"),o=$(".js-promo-code").val().trim(),s=$(".js-stripe-button").data("process-path"),a=e.data("courseId");$.post(s,{stripeEmail:t.email,stripeToken:t.id,quantity:n,promo_code:o,product_code:i,course_id:a,referrer:$(".js-stripe-button").data("referrer").trim()}).fail(function(t){console.log("Stripe call failed: "+t)}).done(function(t){window.location.href=t})}});$(".js-stripe-button").on("click",function(t){t.preventDefault();var e=$(".js-purchase-option:checked"),n=e.val().trim(),i=e.data("product-code"),o=$(".js-promo-code").val().trim(),s=e.data("course-id"),a=$(".js-payments-paths").data("validate-path");$.post(a,{quantity:n,promo_code:o,product_code:i,course_id:s}).fail(function(t){$(".js-payment-details").html(t.responseText),$("#payment_details_modal").modal("show"),initRedeemPromoCodeButtonListener()}).done(function(){var t=$(".js-payments-paths").data("calculate-total-path");$.get(t,{quantity:n,promo_code:o,product_code:i,course_id:s},null,"json").success(function(t){console.log(spluralize(n,i)),"undefined"!=typeof analytics&&(analytics.track("payment",{product_code:i,promo_code:o,currency:r,quantity:n,amount:t.price_in_cents}),console.log("payment event sent")),l.open({description:t.title,amount:t.price_in_cents})})})}),$(window).on("popstate",function(){l.close()})}var n=$(".js-change-credit-card");if(n.length){var e=StripeCheckout.configure({key:n.data("key"),locale:"auto",token:function c(t){var e=n.data("process-path");$.post(e,{stripeToken:t.id,referrer:n.data("referrer").trim()}).fail(function(t){console.log("Stripe call failed: "+t)}).done(function(t){window.location.href=t})}});n.on("click",function(t){t.preventDefault(),e.open({description:"Update Card Details",panelLabel:"Update Card Details"}),$(window).on("popstate",function(){e.close()})})}},spluralize=function spluralize(t,e){return 1==t?t+" "+e:t+" "+e+"s"},initPayments=function initPayments(){initPaymentsPage(),updateTotal(),initRadioButtonListener(),initOtherRadioButtonListener(),initOtherInputListener(),initAddPromoCodeButtonListener(),initStripeButton()};ql.Permissions=function(t){var e=this;this.button=t,this.menu=new ql.PermissionsMenu($('ul[for="'+this.button.attr("id")+'"]')),this.overlay=$('aside[for="'+this.button.attr("id")+'"]'),this.permissions=this.button.data("permissions"),this.menu.setPermissions=function(t){e.setPermissions(t)},this.button.click(function(){e.menu.isVisible=!0,e.render()}),this.overlay.click(function(){e.menu.isVisible=!1,e.render()}),this.render()},ql.Permissions.prototype.setPermissions=function(t){var e=this.permissions.indexOf(t);0<=e?this.permissions.splice(e,1):this.permissions.push(t),$(".js-permissions-input").val(this.permissions.join("\r\n")),this.render()},ql.Permissions.prototype.render=function(){for(var t=[],e=0;e<this.permissions.length;e++)t.push("<span>"+this.permissions[e]+"</span>");this.button.find("#permissions-display").html(t),this.menu.render()},ql.PermissionsMenu=function(t){var e=this;this.element=t,this.isVisible=!1,this.setPermissions="",this.categories=[];for(var n=this.element.children("li"),i=0;i<n.length;i++)this.categories.push(new ql.PermissionsMenuCategory($(n[i]))),this.categories[i].setPermissions=function(t){e.setPermissions(t)}},ql.PermissionsMenu.prototype.render=function(){this.isVisible?this.element.addClass("is-visible"):this.element.removeClass("is-visible");for(var t=0;t<this.categories.length;t++)this.categories[t].render()},ql.PermissionsMenuCategory=function(t){var e=this;this.element=t,this.isSelected=!1,this.setPermissions="",this.items=[];for(var n=this.element.find("[data-permission]"),i=0;i<n.length;i++)this.items.push(new ql.PermissionsMenuItem($(n[i]))),this.items[i].setPermissions=function(t){e.setPermissions(t)}},ql.PermissionsMenuCategory.prototype.setSelected=function(){this.isSelected=!1;for(var t=0;t<this.items.length;t++)this.items[t].isSelected&&(this.isSelected=!0)},ql.PermissionsMenuCategory.prototype.render=function(){this.setSelected(),this.isSelected?this.element.addClass("is-selected"):this.element.removeClass("is-selected");for(var t=0;t<this.items.length;t++)this.items[t].render()},ql.PermissionsMenuItem=function(t){var e=this;this.element=t,this.isSelected=this.element[0].hasAttribute("data-selected"),this.permission=t.data("permission"),this.setPermissions="",this.element.click(function(){e.isSelected=!e.isSelected,e.setPermissions(e.permission)})},ql.PermissionsMenuItem.prototype.render=function(){this.isSelected?this.element.addClass("is-selected"):this.element.removeClass("is-selected")};var initPermissionsSelect=function initPermissionsSelect(){ql.permissions=new ql.Permissions($(".js-permissions"))};ql.initPublishModal=function(){$("#publish_modal").on("show.bs.modal",function(){ql.updatePublishModal(),setInterval(ql.updatePublishModal,5e3)}).modal()},ql.updatePublishModal=function(){console.log("updating publish modal");var e=$(".js-status").data("lab-id"),t=$(".js-status").data("url");$.get(t).done(function(t){"done"==t.status?window.location.href="/labs/"+e+"/snapshots/new":($("#snapshotJobModal .status").html("["+t.id+"] "+t.status),null!=t.message&&$("#snapshotJobModal .message").html(t.message))})},ql.quest={layout:function(){function t(){i=document.querySelector(".js-quest-sidebar"),n=document.querySelector(".js-quest-wrapper"),o=n.offsetTop,(s=document.querySelector("main")).addEventListener("scroll",e,!1)}function e(){requestAnimationFrame(function(){s.scrollTop>o-a?i.classList.add("is-stuck"):i.classList.remove("is-stuck")})}var n=undefined,i=undefined,o=undefined,s=undefined,a=117;return{init:t}}(),analytics:function(){function t(){var t={questName:gon.learning_path_name,label:gon.learning_path_name,category:"Quest",deployment:gon.deployment},e=document.querySelector(".js-quest-enroll-button"),n=document.querySelector(".js-quest-unenroll-button");document.querySelectorAll(".js-catalog-item-title a").forEach(function(t){return t.addEventListener("click",function(t){ql.track("clicked_quest_activity_link",{label:t.target.innerText,type:t.target.dataset.type})},!1)}),e&&e.addEventListener("click",function(){ql.track("clicked_quest_enroll_button",t)}),n&&n.addEventListener("click",function(){ql.track("clicked_quest_unenroll_button",t)})}return{init:t}}()};var initSearchAutocomplete=function initSearchAutocomplete(){jQuery.ui.autocomplete.prototype._resizeMenu=function(){this.menu.element.outerWidth(this.element.outerWidth())},0<$(".js-autocomplete").length&&$.getJSON("/searches/autocomplete.json",function(t){window.SEARCH_AUTOCOMPLETE_DISABLED||(t=t.map($.trim).sort(function(t,e){return t.localeCompare(e)}),$(".js-autocomplete").autocomplete({source:t}))})},disableSearchAutocomplete=function disableSearchAutocomplete(){$(".js-autocomplete").autocomplete("instance")&&$(".js-autocomplete").autocomplete("disable")},initSearch=function initSearch(){initSearchAutocomplete(),$searchInput=document.getElementById("keywords"),$searchInput&&$searchInput.addEventListener("keydown",function(t){t.isComposing||13!=t.keyCode||ql.track("searched",{label:t.target.value})})};$(function(){function t(){var t=ql.experiments.getActiveExperiments().map(function(t){return t.optimize_id+"."+t.variant_index}).join("!");ga("set","exp",t)}if(gon.segment!=undefined){!function(){var n=window.analytics=window.analytics||[];if(!n.initialize)if(n.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{n.invoked=!0,n.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"],n.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(e),n.push(t),n}};for(var t=0;t<n.methods.length;t++){var e=n.methods[t];n[e]=n.factory(e)}n.load=function(t){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)},n.SNIPPET_VERSION="3.1.0",n.load(gon.segment)}}();var e="none";if(gon.deployment!=undefined&&(e=gon.deployment),gon.hasOwnProperty("current_user")){var n=gon.current_user;analytics.identify(e+"-"+n.id,{email:n.email,first_name:n.firstname,last_name:n.lastname,company:n.company,origin:n.origin,name:n.fullname,subscriptions:n.subscriptions,qlCreatedAt:n.qlCreatedAt,optIn:n.optIn,deployment:e})}analytics.ready(function(){t(),analytics.page()})}}),initQuestCollapse=function(){$(".js-dashboard-quest").click(function(){$(this).find(".js-toggle-arrow").toggleClass("is-shown")})},initDismissAlert=function(){$(".js-dashboard-alert-close").click(function(){$.get($(this).data("dismissed-path"))})},initStudentDashboard=function(){initQuestCollapse(),initDismissAlert()},initFirstTabActive=function(){$(".js-tab").first().addClass("is-active"),$(".js-tab-content").first().addClass("is-active")},initTabListener=function(){$(".js-tab").click(function(){var t=$(this).data("tab");$(".js-tab").removeClass("is-active"),$(this).addClass("is-active"),$(".js-tab-content").removeClass("is-active"),$(
".js-tab-content[data-tab='"+t+"']").addClass("is-active")})},initTabs=function(){initTabListener()},ql.toggleButtons=function(){function t(){document.querySelectorAll(".toggle-button").forEach(function(t){t.hasAttribute("for")?t.addEventListener("click",e,!1):t.disabled=!0})}function e(){this.classList.toggle("is-toggled"),document.getElementById(this.getAttribute("for")).classList.toggle("is-toggled")}return{init:t}}(),initTooltips=function(){$('[data-toggle="tooltip"]').tooltip()};var trans={},initLabTranslations=function initLabTranslations(t){trans=t},initPaymentTranslations=function initPaymentTranslations(t){trans=t},initUnblockAccountButtonListener=function initUnblockAccountButtonListener(){$(".js-unblock-account-button").on("click",function(){console.log("Clicked unblock account button."),"undefined"!=typeof analytics&&analytics.track("unblock_account",{})})};ql.affiliateAutocomplete=function(){function t(){$(".js-affiliate-user-autocomplete").userAutocomplete({source:function i(t,e){var n="?q["+this.element[0].dataset.query+"]="+t.term;ql.getJson(this.element[0].dataset.autocomplete+n).then(function(t){e(t.map(function(t){return{label:t,value:t.email}}))})},open:function t(){$(".js-add-new-user").click(e)}})}function e(){var t=$(".js-affiliate-user-autocomplete").val();$('.js-new-user input[type="email"]').val(t),$(".js-new-user").removeClass("is-hidden"),$(".js-existing-user").addClass("is-hidden")}return{init:t}}();